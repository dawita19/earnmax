import { ColumnDef } from "@tanstack/react-table"
import { User } from "@/types/user"
import { Badge } from "@/components/ui/badge"
import { DataTable } from "@/components/ui/data-table"
import { Button } from "@/components/ui/button"
import { MoreHorizontal } from "lucide-react"
import UserActions from "./UserActions"

export const columns: ColumnDef<User>[] = [
  {
    accessorKey: "user_id",
    header: "ID",
    cell: ({ row }) => <span>{row.getValue("user_id")}</span>
  },
  {
    accessorKey: "full_name",
    header: "Name",
    cell: ({ row }) => (
      <div className="font-medium">
        {row.getValue("full_name")}
        <p className="text-sm text-gray-500">
          {row.original.phone_number}
        </p>
      </div>
    )
  },
  {
    accessorKey: "vip_level",
    header: "VIP Level",
    cell: ({ row }) => (
      <Badge variant={row.getValue("vip_level") > 0 ? "premium" : "default"}>
        Level {row.getValue("vip_level")}
      </Badge>
    )
  },
  {
    accessorKey: "total_earnings",
    header: "Earnings",
    cell: ({ row }) => (
      <span className="font-semibold">
        {Number(row.getValue("total_earnings")).toLocaleString()} ETB
      </span>
    )
  },
  {
    accessorKey: "total_invites",
    header: "Team",
    cell: ({ row }) => (
      <div className="flex space-x-2">
        <Badge variant="outline">{row.getValue("total_invites")} Total</Badge>
        <Badge variant="secondary">{row.original.first_level_invites} 1st</Badge>
      </div>
    )
  },
  {
    id: "actions",
    cell: ({ row }) => <UserActions user={row.original} />
  }
]

interface UsersTableProps {
  data: User[];
  loading?: boolean;
}

export function UsersTable({ data, loading }: UsersTableProps) {
  return (
    <DataTable
      columns={columns}
      data={data}
      loading={loading}
      pagination
      pageSize={10}
      filterable
      filterPlaceholder="Filter users..."
    />
  )
}